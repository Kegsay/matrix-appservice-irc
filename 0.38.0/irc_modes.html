<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>IRC Modes - Matrix IRC Bridge</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="usage.html"><strong aria-hidden="true">2.</strong> Usage</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="admin_room.html"><strong aria-hidden="true">2.1.</strong> Admin Room</a></li><li class="chapter-item expanded "><a href="room_commands.html"><strong aria-hidden="true">2.2.</strong> Room Commands</a></li><li class="chapter-item expanded "><a href="room_configuration.html"><strong aria-hidden="true">2.3.</strong> Room Configuration</a></li><li class="chapter-item expanded "><a href="irc_modes.html" class="active"><strong aria-hidden="true">2.4.</strong> IRC Modes</a></li><li class="chapter-item expanded "><a href="setup_widget.html"><strong aria-hidden="true">2.5.</strong> Setup Widget</a></li></ol></li><li class="chapter-item expanded "><a href="bridged_networks.html"><strong aria-hidden="true">3.</strong> Bridged Networks</a></li><li class="chapter-item expanded "><a href="administrators_guide.html"><strong aria-hidden="true">4.</strong> Bridge Administrators</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="bridge_setup.html"><strong aria-hidden="true">4.1.</strong> Setting up the bridge</a></li><li class="chapter-item expanded "><a href="debug_api.html"><strong aria-hidden="true">4.2.</strong> Debug API</a></li></ol></li><li class="chapter-item expanded "><a href="irc_operators.html"><strong aria-hidden="true">5.</strong> IRC Operators</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Matrix IRC Bridge</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="irc-modes"><a class="header" href="#irc-modes">IRC Modes</a></h1>
<p>This chapter explains how various IRC channel modes are interpreted by the bridge, and how you can best configure your
channels to work well with the bridge.</p>
<p>Note: While the bridge tries to follow the RFCs where possible, due to the somewhat fragmented nature of IRC the bridge is
designed for maximum compatibility with <a href="https://github.com/solanum-ircd/solanum">Libera's IRCd</a>.</p>
<h2 id="user-modes-to-power-levels"><a class="header" href="#user-modes-to-power-levels">User modes to power levels</a></h2>
<p>User modes are mapped to certain power levels on Matrix. For those unaware, Matrix power levels typically range between
0-100 where zero represents a user that may only speak and 100 is an admin of the room (although these are modifiable).</p>
<p>By default the bridge maps users like so:</p>
<pre><code class="language-yaml"># taken from config.sample.yaml
modePowerMap:
    o: 50
    v: 1
</code></pre>
<p>An operator on the IRC side of the bridge will be given moderator privileges (PL50) and a voiced user will be given
PL1. In <code>+m</code> (moderated) rooms, users who are not voiced cannot speak and so the Matrix room will not allow users with
PL0 (that is, without +v) to speak.</p>
<p>The IRC bridge admin can customise this power level mapping to however they see fit.</p>
<h2 id="channel-modes-that-prevent-bridged-users-from-joining"><a class="header" href="#channel-modes-that-prevent-bridged-users-from-joining">Channel modes that prevent bridged users from joining</a></h2>
<p>Below are some common channel modes that prevent bridged users from joining. The modes in parentheses and the examples
given are for Libera.Chat, other IRCds may have different mode letters or not have the capability at all, so consult the
help documentation of channel for other networks to find out what they support.</p>
<p>If a user is not able to join the IRC channel, they will be kicked from the Matrix room. The reason is given in the
Matrix kick message, and a more verbose error is given in the user's admin room.</p>
<h3 id="ban-b"><a class="header" href="#ban-b">Ban (<code>+b</code>)</a></h3>
<p>If the user matches a ban mask on the IRC channel, they cannot join. An IRC channel op can exempt a specific bridged
user by setting a ban exemption mask (<code>+e</code>) in two ways, either using the IP address of the bridged user:</p>
<pre><code>/mode #channel +e *!*@2001:470:69fc:105::b2ed
</code></pre>
<p>or, if the Matrix user is identified to services, using the <code>$a</code> extban syntax:</p>
<pre><code>/mode #channel +e $a:matrixuser
</code></pre>
<p>Note that exempting a user means that user will not be affected by bans or quiets,
so be sure you trust the user before giving them an exemption.</p>
<h3 id="invite-only-i"><a class="header" href="#invite-only-i">Invite only (<code>+i</code>)</a></h3>
<p>Some communities prefer to keep their channels invite only but allow the bridge to access the channel. An IRC channel
operator can set an invite exemption (<code>+I</code>) mask for the whole bridge:</p>
<pre><code>/mode #channel +I *!*@2001:470:69fc:105::/64
</code></pre>
<p>This will also work on other IRC networks that support IPv6 and do not automatically cloak hosts (notably OFTC), however
the IP address range will be different. Running <code>/whois</code> on a Matrix user nick will give you the IPv6 /64 range to use.</p>
<p>Adding an invite exemption for a single Matrix user is done the same way as the ban exemption methods above, replacing <code>+e</code>
with <code>+I</code>.</p>
<h3 id="registered-only-r"><a class="header" href="#registered-only-r">Registered only (<code>+r</code>)</a></h3>
<p>If <code>+r</code> is set on a channel, Matrix users not identified to services cannot join.</p>
<h3 id="key-protected-k"><a class="header" href="#key-protected-k">Key protected (<code>+k</code>)</a></h3>
<p>If a channel is protected by a key, it cannot be entered by joining via an alias. Instead you may join by using
the <a href="admin_room#join"><code>!join</code></a> command. Be aware that the bridge purposefully does not store channel keys in
the database as a security precaution so you should be expected to do this again on bridge restart.</p>
<h3 id="channel-forwarding-f"><a class="header" href="#channel-forwarding-f">Channel Forwarding (<code>+f</code>)</a></h3>
<p>Channel forwarding is presently unsupported, see https://github.com/matrix-org/matrix-appservice-irc/issues/214
for information and updates.</p>
<h2 id="other-important-channel-modes"><a class="header" href="#other-important-channel-modes">Other important channel modes</a></h2>
<p>These channel modes do not prevent a user from joining, but they still affect various properties of the room.</p>
<h3 id="secret-s"><a class="header" href="#secret-s">Secret (<code>+s</code>)</a></h3>
<p>By default the IRC bridge will automatically insert any newly joined rooms into the homeserver's room directory.
The <code>+s</code> mode will mark the channel as secret and the bridge will not show it in the directory. The room will still
be joinable however.</p>
<h3 id="moderated-m"><a class="header" href="#moderated-m">Moderated (<code>+m</code>)</a></h3>
<p>When mode <code>+m</code> is set, any users with a powerlevel of 0 (i.e. not opped or voiced) will be prevented from talking.</p>
<h3 id="quiet-q"><a class="header" href="#quiet-q">Quiet (<code>+q</code>)</a></h3>
<p>A quiet mask is similar to a ban mask, but only prevents the user from talking, not joining. If a Matrix user matches
a quiet mask, the message will not be sent to IRC but will still be sent to the Matrix room.</p>
<h3 id="op-moderated-z"><a class="header" href="#op-moderated-z">Op moderated (<code>+z</code>)</a></h3>
<p>When mode <code>+z</code> is set, messages that are normally blocked by <code>+m</code>, <code>+b</code>, and <code>+q</code> are instead sent to channel operators
using a statusmsg. The bridge currently does not understand how <code>+z</code> works, so setting <code>+mz</code> will still block Matrix
users with a powerlevel of 0 from talking in the channel.</p>
<p>Additionally, the bridge doesn't support statusmsg, so if the channel is set <code>+mz</code>, any messages that are affected by it
do not appear in the Matrix room.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="room_configuration.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="setup_widget.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="room_configuration.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="setup_widget.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
